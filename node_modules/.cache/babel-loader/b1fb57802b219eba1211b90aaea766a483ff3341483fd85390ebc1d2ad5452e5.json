{"ast":null,"code":"/*global chrome*/import{extract}from\"@extractus/article-extractor\";import{PromptTemplate}from\"@langchain/core/prompts\";import{ChatOpenAI}from\"@langchain/openai\";import{OpenAIEmbeddings}from\"@langchain/openai\";import{StringOutputParser}from\"@langchain/core/output_parsers\";import{RunnableSequence}from\"@langchain/core/runnables\";import{RunnablePassthrough}from\"@langchain/core/runnables\";async function extractor(url){/*\n  function getURL() {\n    var url = \"\";\n    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n      var currTab = tabs[0];\n      url = currTab.url;\n      console.log(\"Current tab URL:\", url);\n    });\n    input = url;\n  }*/var input=\"\";async function getURL(){return new Promise((resolve,reject)=>{chrome.tabs.query({active:true,currentWindow:true},tabs=>{var currTab=tabs[0];var url=currTab.url;console.log(\"Current tab URL:\",url);input=url;});});}await getURL();console.log(\"input\");console.log(input);//\"https://www.bbc.com/news/world-europe-68323366\";\nvar article=\"\";// here we use top-level await, assume current platform supports it\ntry{article=await extract(input);}catch(err){console.error(err);}//console.log(article);\nconsole.log(typeof article);console.log(input);let curr_article={title:article.title,author:article.author,publish_date:article.published,content:article.content,topics:[],genre:\"\",key_word_search:\"\"};console.log(\"curr:\");console.log(curr_article);const openAIAPIKey=\"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\";const embeddings=new OpenAIEmbeddings({openAIApiKey:openAIAPIKey});const llm=new ChatOpenAI({openAIApiKey:openAIAPIKey});const testTemplate=\"given the content of the file, only produce the content as a string without the html tags and tabs. \\\n                        Include a list of topics discussed in the article.    \\\n                        Also identify the genre of the article (e.g. political, health, science)      \\\n                        Come up with a 5 key word search for google to find out more information about the article. \\\n                        Format the output in json to be a dictionary containing content (content), topics (topic), genre (genre), \\\n                        and one sentence to inquire further about the article (key_word_search).\\\n                        The variable names are defined in parentheses for each entry in the dictionary. \\\n                        The content will be a string, topics will be a list of a string of topics, \\\n                        genre will be a string, and the key_word_search will be a string. file:{file} article:\";const testPrompt=PromptTemplate.fromTemplate(testTemplate);const testchain=RunnableSequence.from([testPrompt,llm,new StringOutputParser()]);const response=await testchain.invoke({file:article.content});console.log(response);var output=JSON.parse(response);// console.log(output);\n// console.log(output.content);\n// console.log(output.topics);\ncurr_article.content=output.content;curr_article.topics=output.topics;curr_article.genre=output.genre;curr_article.key_word_search=output.key_word_search;console.log(\"final\");console.log(curr_article);}export default extractor;","map":{"version":3,"names":["extract","PromptTemplate","ChatOpenAI","OpenAIEmbeddings","StringOutputParser","RunnableSequence","RunnablePassthrough","extractor","url","input","getURL","Promise","resolve","reject","chrome","tabs","query","active","currentWindow","currTab","console","log","article","err","error","curr_article","title","author","publish_date","published","content","topics","genre","key_word_search","openAIAPIKey","embeddings","openAIApiKey","llm","testTemplate","testPrompt","fromTemplate","testchain","from","response","invoke","file","output","JSON","parse"],"sources":["/Users/mandylin/Desktop/WebCrack React/webcrack/src/extractor.mjs"],"sourcesContent":["/*global chrome*/\nimport { extract } from \"@extractus/article-extractor\";\nimport { PromptTemplate } from \"@langchain/core/prompts\";\nimport { ChatOpenAI } from \"@langchain/openai\";\nimport { OpenAIEmbeddings } from \"@langchain/openai\";\nimport { StringOutputParser } from \"@langchain/core/output_parsers\";\nimport { RunnableSequence } from \"@langchain/core/runnables\";\nimport { RunnablePassthrough } from \"@langchain/core/runnables\";\n\nasync function extractor(url) {\n  /*\n  function getURL() {\n    var url = \"\";\n    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n      var currTab = tabs[0];\n      url = currTab.url;\n      console.log(\"Current tab URL:\", url);\n    });\n    input = url;\n  }*/\n  var input = \"\";\n  async function getURL() {\n    return new Promise((resolve, reject) => {\n      chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n        var currTab = tabs[0];\n        var url = currTab.url;\n        console.log(\"Current tab URL:\", url);\n        input = url;\n      });\n    });\n  }\n\n  await getURL();\n  console.log(\"input\");\n  console.log(input);\n\n  //\"https://www.bbc.com/news/world-europe-68323366\";\n\n  var article = \"\";\n  // here we use top-level await, assume current platform supports it\n  try {\n    article = await extract(input);\n  } catch (err) {\n    console.error(err);\n  }\n\n  //console.log(article);\n\n  console.log(typeof article);\n  console.log(input);\n\n  let curr_article = {\n    title: article.title,\n    author: article.author,\n    publish_date: article.published,\n    content: article.content,\n    topics: [],\n    genre: \"\",\n    key_word_search: \"\",\n  };\n  console.log(\"curr:\");\n  console.log(curr_article);\n\n  const openAIAPIKey = \"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\";\n  const embeddings = new OpenAIEmbeddings({ openAIApiKey: openAIAPIKey });\n\n  const llm = new ChatOpenAI({ openAIApiKey: openAIAPIKey });\n\n  const testTemplate =\n    \"given the content of the file, only produce the content as a string without the html tags and tabs. \\\n                        Include a list of topics discussed in the article.    \\\n                        Also identify the genre of the article (e.g. political, health, science)      \\\n                        Come up with a 5 key word search for google to find out more information about the article. \\\n                        Format the output in json to be a dictionary containing content (content), topics (topic), genre (genre), \\\n                        and one sentence to inquire further about the article (key_word_search).\\\n                        The variable names are defined in parentheses for each entry in the dictionary. \\\n                        The content will be a string, topics will be a list of a string of topics, \\\n                        genre will be a string, and the key_word_search will be a string. file:{file} article:\";\n\n  const testPrompt = PromptTemplate.fromTemplate(testTemplate);\n  const testchain = RunnableSequence.from([\n    testPrompt,\n    llm,\n    new StringOutputParser(),\n  ]);\n\n  const response = await testchain.invoke({ file: article.content });\n\n  console.log(response);\n\n  var output = JSON.parse(response);\n\n  // console.log(output);\n  // console.log(output.content);\n  // console.log(output.topics);\n\n  curr_article.content = output.content;\n  curr_article.topics = output.topics;\n  curr_article.genre = output.genre;\n  curr_article.key_word_search = output.key_word_search;\n  console.log(\"final\");\n  console.log(curr_article);\n}\n\nexport default extractor;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}