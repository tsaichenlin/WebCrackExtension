{"ast":null,"code":"import { v4 as uuidv4 } from \"uuid\";\nimport { BaseCallbackHandler } from \"./base.js\";\nimport { ConsoleCallbackHandler } from \"../tracers/console.js\";\nimport { getTracingV2CallbackHandler } from \"../tracers/initialize.js\";\nimport { getBufferString } from \"../messages/index.js\";\nimport { getEnvironmentVariable } from \"../utils/env.js\";\nimport { LangChainTracer } from \"../tracers/tracer_langchain.js\";\nimport { consumeCallback } from \"./promises.js\";\nexport function parseCallbackConfigArg(arg) {\n  if (!arg) {\n    return {};\n  } else if (Array.isArray(arg) || \"name\" in arg) {\n    return {\n      callbacks: arg\n    };\n  } else {\n    return arg;\n  }\n}\n/**\n * Manage callbacks from different components of LangChain.\n */\nexport class BaseCallbackManager {\n  setHandler(handler) {\n    return this.setHandlers([handler]);\n  }\n}\n/**\n * Base class for run manager in LangChain.\n */\nclass BaseRunManager {\n  constructor(runId, handlers, inheritableHandlers, tags, inheritableTags, metadata, inheritableMetadata, _parentRunId) {\n    Object.defineProperty(this, \"runId\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: runId\n    });\n    Object.defineProperty(this, \"handlers\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: handlers\n    });\n    Object.defineProperty(this, \"inheritableHandlers\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: inheritableHandlers\n    });\n    Object.defineProperty(this, \"tags\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: tags\n    });\n    Object.defineProperty(this, \"inheritableTags\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: inheritableTags\n    });\n    Object.defineProperty(this, \"metadata\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: metadata\n    });\n    Object.defineProperty(this, \"inheritableMetadata\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: inheritableMetadata\n    });\n    Object.defineProperty(this, \"_parentRunId\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: _parentRunId\n    });\n  }\n  async handleText(text) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      try {\n        var _handler$handleText;\n        await ((_handler$handleText = handler.handleText) === null || _handler$handleText === void 0 ? void 0 : _handler$handleText.call(handler, text, this.runId, this._parentRunId, this.tags));\n      } catch (err) {\n        console.error(\"Error in handler \".concat(handler.constructor.name, \", handleText: \").concat(err));\n      }\n    }, handler.awaitHandlers)));\n  }\n}\n/**\n * Manages callbacks for retriever runs.\n */\nexport class CallbackManagerForRetrieverRun extends BaseRunManager {\n  getChild(tag) {\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n    const manager = new CallbackManager(this.runId);\n    manager.setHandlers(this.inheritableHandlers);\n    manager.addTags(this.inheritableTags);\n    manager.addMetadata(this.inheritableMetadata);\n    if (tag) {\n      manager.addTags([tag], false);\n    }\n    return manager;\n  }\n  async handleRetrieverEnd(documents) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreRetriever) {\n        try {\n          var _handler$handleRetrie;\n          await ((_handler$handleRetrie = handler.handleRetrieverEnd) === null || _handler$handleRetrie === void 0 ? void 0 : _handler$handleRetrie.call(handler, documents, this.runId, this._parentRunId, this.tags));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleRetriever\"));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n  async handleRetrieverError(err) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreRetriever) {\n        try {\n          var _handler$handleRetrie2;\n          await ((_handler$handleRetrie2 = handler.handleRetrieverError) === null || _handler$handleRetrie2 === void 0 ? void 0 : _handler$handleRetrie2.call(handler, err, this.runId, this._parentRunId, this.tags));\n        } catch (error) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleRetrieverError: \").concat(error));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n}\nexport class CallbackManagerForLLMRun extends BaseRunManager {\n  async handleLLMNewToken(token, idx, _runId, _parentRunId, _tags, fields) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreLLM) {\n        try {\n          var _handler$handleLLMNew;\n          await ((_handler$handleLLMNew = handler.handleLLMNewToken) === null || _handler$handleLLMNew === void 0 ? void 0 : _handler$handleLLMNew.call(handler, token, idx !== null && idx !== void 0 ? idx : {\n            prompt: 0,\n            completion: 0\n          }, this.runId, this._parentRunId, this.tags, fields));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleLLMNewToken: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n  async handleLLMError(err) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreLLM) {\n        try {\n          var _handler$handleLLMErr;\n          await ((_handler$handleLLMErr = handler.handleLLMError) === null || _handler$handleLLMErr === void 0 ? void 0 : _handler$handleLLMErr.call(handler, err, this.runId, this._parentRunId, this.tags));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleLLMError: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n  async handleLLMEnd(output) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreLLM) {\n        try {\n          var _handler$handleLLMEnd;\n          await ((_handler$handleLLMEnd = handler.handleLLMEnd) === null || _handler$handleLLMEnd === void 0 ? void 0 : _handler$handleLLMEnd.call(handler, output, this.runId, this._parentRunId, this.tags));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleLLMEnd: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n}\nexport class CallbackManagerForChainRun extends BaseRunManager {\n  getChild(tag) {\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n    const manager = new CallbackManager(this.runId);\n    manager.setHandlers(this.inheritableHandlers);\n    manager.addTags(this.inheritableTags);\n    manager.addMetadata(this.inheritableMetadata);\n    if (tag) {\n      manager.addTags([tag], false);\n    }\n    return manager;\n  }\n  async handleChainError(err, _runId, _parentRunId, _tags, kwargs) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreChain) {\n        try {\n          var _handler$handleChainE;\n          await ((_handler$handleChainE = handler.handleChainError) === null || _handler$handleChainE === void 0 ? void 0 : _handler$handleChainE.call(handler, err, this.runId, this._parentRunId, this.tags, kwargs));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleChainError: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n  async handleChainEnd(output, _runId, _parentRunId, _tags, kwargs) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreChain) {\n        try {\n          var _handler$handleChainE2;\n          await ((_handler$handleChainE2 = handler.handleChainEnd) === null || _handler$handleChainE2 === void 0 ? void 0 : _handler$handleChainE2.call(handler, output, this.runId, this._parentRunId, this.tags, kwargs));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleChainEnd: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n  async handleAgentAction(action) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreAgent) {\n        try {\n          var _handler$handleAgentA;\n          await ((_handler$handleAgentA = handler.handleAgentAction) === null || _handler$handleAgentA === void 0 ? void 0 : _handler$handleAgentA.call(handler, action, this.runId, this._parentRunId, this.tags));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleAgentAction: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n  async handleAgentEnd(action) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreAgent) {\n        try {\n          var _handler$handleAgentE;\n          await ((_handler$handleAgentE = handler.handleAgentEnd) === null || _handler$handleAgentE === void 0 ? void 0 : _handler$handleAgentE.call(handler, action, this.runId, this._parentRunId, this.tags));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleAgentEnd: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n}\nexport class CallbackManagerForToolRun extends BaseRunManager {\n  getChild(tag) {\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n    const manager = new CallbackManager(this.runId);\n    manager.setHandlers(this.inheritableHandlers);\n    manager.addTags(this.inheritableTags);\n    manager.addMetadata(this.inheritableMetadata);\n    if (tag) {\n      manager.addTags([tag], false);\n    }\n    return manager;\n  }\n  async handleToolError(err) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreAgent) {\n        try {\n          var _handler$handleToolEr;\n          await ((_handler$handleToolEr = handler.handleToolError) === null || _handler$handleToolEr === void 0 ? void 0 : _handler$handleToolEr.call(handler, err, this.runId, this._parentRunId, this.tags));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleToolError: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n  async handleToolEnd(output) {\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreAgent) {\n        try {\n          var _handler$handleToolEn;\n          await ((_handler$handleToolEn = handler.handleToolEnd) === null || _handler$handleToolEn === void 0 ? void 0 : _handler$handleToolEn.call(handler, output, this.runId, this._parentRunId, this.tags));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleToolEnd: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n  }\n}\n/**\n * @example\n * ```typescript\n * const prompt = PromptTemplate.fromTemplate(\"What is the answer to {question}?\");\n *\n * // Example of using LLMChain with OpenAI and a simple prompt\n * const chain = new LLMChain({\n *   llm: new ChatOpenAI({ temperature: 0.9 }),\n *   prompt,\n * });\n *\n * // Running the chain with a single question\n * const result = await chain.call({\n *   question: \"What is the airspeed velocity of an unladen swallow?\",\n * });\n * console.log(\"The answer is:\", result);\n * ```\n */\nexport class CallbackManager extends BaseCallbackManager {\n  constructor(parentRunId, options) {\n    var _options$handlers, _options$inheritableH, _options$tags, _options$inheritableT, _options$metadata, _options$inheritableM;\n    super();\n    Object.defineProperty(this, \"handlers\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"inheritableHandlers\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"tags\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"inheritableTags\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"metadata\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(this, \"inheritableMetadata\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(this, \"name\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: \"callback_manager\"\n    });\n    Object.defineProperty(this, \"_parentRunId\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    this.handlers = (_options$handlers = options === null || options === void 0 ? void 0 : options.handlers) !== null && _options$handlers !== void 0 ? _options$handlers : this.handlers;\n    this.inheritableHandlers = (_options$inheritableH = options === null || options === void 0 ? void 0 : options.inheritableHandlers) !== null && _options$inheritableH !== void 0 ? _options$inheritableH : this.inheritableHandlers;\n    this.tags = (_options$tags = options === null || options === void 0 ? void 0 : options.tags) !== null && _options$tags !== void 0 ? _options$tags : this.tags;\n    this.inheritableTags = (_options$inheritableT = options === null || options === void 0 ? void 0 : options.inheritableTags) !== null && _options$inheritableT !== void 0 ? _options$inheritableT : this.inheritableTags;\n    this.metadata = (_options$metadata = options === null || options === void 0 ? void 0 : options.metadata) !== null && _options$metadata !== void 0 ? _options$metadata : this.metadata;\n    this.inheritableMetadata = (_options$inheritableM = options === null || options === void 0 ? void 0 : options.inheritableMetadata) !== null && _options$inheritableM !== void 0 ? _options$inheritableM : this.inheritableMetadata;\n    this._parentRunId = parentRunId;\n  }\n  async handleLLMStart(llm, prompts) {\n    let _runId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n    let _parentRunId = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n    let extraParams = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : undefined;\n    let _tags = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n    let _metadata = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : undefined;\n    let runName = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : undefined;\n    return Promise.all(prompts.map(async prompt => {\n      const runId = uuidv4();\n      await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n        if (!handler.ignoreLLM) {\n          try {\n            var _handler$handleLLMSta;\n            await ((_handler$handleLLMSta = handler.handleLLMStart) === null || _handler$handleLLMSta === void 0 ? void 0 : _handler$handleLLMSta.call(handler, llm, [prompt], runId, this._parentRunId, extraParams, this.tags, this.metadata, runName));\n          } catch (err) {\n            console.error(\"Error in handler \".concat(handler.constructor.name, \", handleLLMStart: \").concat(err));\n          }\n        }\n      }, handler.awaitHandlers)));\n      return new CallbackManagerForLLMRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n    }));\n  }\n  async handleChatModelStart(llm, messages) {\n    let _runId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n    let _parentRunId = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n    let extraParams = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : undefined;\n    let _tags = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n    let _metadata = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : undefined;\n    let runName = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : undefined;\n    return Promise.all(messages.map(async messageGroup => {\n      const runId = uuidv4();\n      await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n        if (!handler.ignoreLLM) {\n          try {\n            if (handler.handleChatModelStart) {\n              var _handler$handleChatMo;\n              await ((_handler$handleChatMo = handler.handleChatModelStart) === null || _handler$handleChatMo === void 0 ? void 0 : _handler$handleChatMo.call(handler, llm, [messageGroup], runId, this._parentRunId, extraParams, this.tags, this.metadata, runName));\n            } else if (handler.handleLLMStart) {\n              var _handler$handleLLMSta2;\n              const messageString = getBufferString(messageGroup);\n              await ((_handler$handleLLMSta2 = handler.handleLLMStart) === null || _handler$handleLLMSta2 === void 0 ? void 0 : _handler$handleLLMSta2.call(handler, llm, [messageString], runId, this._parentRunId, extraParams, this.tags, this.metadata, runName));\n            }\n          } catch (err) {\n            console.error(\"Error in handler \".concat(handler.constructor.name, \", handleLLMStart: \").concat(err));\n          }\n        }\n      }, handler.awaitHandlers)));\n      return new CallbackManagerForLLMRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n    }));\n  }\n  async handleChainStart(chain, inputs) {\n    let runId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : uuidv4();\n    let runType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n    let _tags = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : undefined;\n    let _metadata = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n    let runName = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : undefined;\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreChain) {\n        try {\n          var _handler$handleChainS;\n          await ((_handler$handleChainS = handler.handleChainStart) === null || _handler$handleChainS === void 0 ? void 0 : _handler$handleChainS.call(handler, chain, inputs, runId, this._parentRunId, this.tags, this.metadata, runType, runName));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleChainStart: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n    return new CallbackManagerForChainRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n  }\n  async handleToolStart(tool, input) {\n    let runId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : uuidv4();\n    let _parentRunId = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n    let _tags = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : undefined;\n    let _metadata = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n    let runName = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : undefined;\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreAgent) {\n        try {\n          var _handler$handleToolSt;\n          await ((_handler$handleToolSt = handler.handleToolStart) === null || _handler$handleToolSt === void 0 ? void 0 : _handler$handleToolSt.call(handler, tool, input, runId, this._parentRunId, this.tags, this.metadata, runName));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleToolStart: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n    return new CallbackManagerForToolRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n  }\n  async handleRetrieverStart(retriever, query) {\n    let runId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : uuidv4();\n    let _parentRunId = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n    let _tags = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : undefined;\n    let _metadata = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n    let runName = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : undefined;\n    await Promise.all(this.handlers.map(handler => consumeCallback(async () => {\n      if (!handler.ignoreRetriever) {\n        try {\n          var _handler$handleRetrie3;\n          await ((_handler$handleRetrie3 = handler.handleRetrieverStart) === null || _handler$handleRetrie3 === void 0 ? void 0 : _handler$handleRetrie3.call(handler, retriever, query, runId, this._parentRunId, this.tags, this.metadata, runName));\n        } catch (err) {\n          console.error(\"Error in handler \".concat(handler.constructor.name, \", handleRetrieverStart: \").concat(err));\n        }\n      }\n    }, handler.awaitHandlers)));\n    return new CallbackManagerForRetrieverRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n  }\n  addHandler(handler) {\n    let inherit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    this.handlers.push(handler);\n    if (inherit) {\n      this.inheritableHandlers.push(handler);\n    }\n  }\n  removeHandler(handler) {\n    this.handlers = this.handlers.filter(_handler => _handler !== handler);\n    this.inheritableHandlers = this.inheritableHandlers.filter(_handler => _handler !== handler);\n  }\n  setHandlers(handlers) {\n    let inherit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    this.handlers = [];\n    this.inheritableHandlers = [];\n    for (const handler of handlers) {\n      this.addHandler(handler, inherit);\n    }\n  }\n  addTags(tags) {\n    let inherit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    this.removeTags(tags); // Remove duplicates\n    this.tags.push(...tags);\n    if (inherit) {\n      this.inheritableTags.push(...tags);\n    }\n  }\n  removeTags(tags) {\n    this.tags = this.tags.filter(tag => !tags.includes(tag));\n    this.inheritableTags = this.inheritableTags.filter(tag => !tags.includes(tag));\n  }\n  addMetadata(metadata) {\n    let inherit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    this.metadata = {\n      ...this.metadata,\n      ...metadata\n    };\n    if (inherit) {\n      this.inheritableMetadata = {\n        ...this.inheritableMetadata,\n        ...metadata\n      };\n    }\n  }\n  removeMetadata(metadata) {\n    for (const key of Object.keys(metadata)) {\n      delete this.metadata[key];\n      delete this.inheritableMetadata[key];\n    }\n  }\n  copy() {\n    let additionalHandlers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    let inherit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    const manager = new CallbackManager(this._parentRunId);\n    for (const handler of this.handlers) {\n      const inheritable = this.inheritableHandlers.includes(handler);\n      manager.addHandler(handler, inheritable);\n    }\n    for (const tag of this.tags) {\n      const inheritable = this.inheritableTags.includes(tag);\n      manager.addTags([tag], inheritable);\n    }\n    for (const key of Object.keys(this.metadata)) {\n      const inheritable = Object.keys(this.inheritableMetadata).includes(key);\n      manager.addMetadata({\n        [key]: this.metadata[key]\n      }, inheritable);\n    }\n    for (const handler of additionalHandlers) {\n      if (\n      // Prevent multiple copies of console_callback_handler\n      manager.handlers.filter(h => h.name === \"console_callback_handler\").some(h => h.name === handler.name)) {\n        continue;\n      }\n      manager.addHandler(handler, inherit);\n    }\n    return manager;\n  }\n  static fromHandlers(handlers) {\n    class Handler extends BaseCallbackHandler {\n      constructor() {\n        super();\n        Object.defineProperty(this, \"name\", {\n          enumerable: true,\n          configurable: true,\n          writable: true,\n          value: uuidv4()\n        });\n        Object.assign(this, handlers);\n      }\n    }\n    const manager = new this();\n    manager.addHandler(new Handler());\n    return manager;\n  }\n  static async configure(inheritableHandlers, localHandlers, inheritableTags, localTags, inheritableMetadata, localMetadata, options) {\n    var _getEnvironmentVariab;\n    let callbackManager;\n    if (inheritableHandlers || localHandlers) {\n      if (Array.isArray(inheritableHandlers) || !inheritableHandlers) {\n        var _inheritableHandlers$;\n        callbackManager = new CallbackManager();\n        callbackManager.setHandlers((_inheritableHandlers$ = inheritableHandlers === null || inheritableHandlers === void 0 ? void 0 : inheritableHandlers.map(ensureHandler)) !== null && _inheritableHandlers$ !== void 0 ? _inheritableHandlers$ : [], true);\n      } else {\n        callbackManager = inheritableHandlers;\n      }\n      callbackManager = callbackManager.copy(Array.isArray(localHandlers) ? localHandlers.map(ensureHandler) : localHandlers === null || localHandlers === void 0 ? void 0 : localHandlers.handlers, false);\n    }\n    const verboseEnabled = getEnvironmentVariable(\"LANGCHAIN_VERBOSE\") === \"true\" || (options === null || options === void 0 ? void 0 : options.verbose);\n    const tracingV2Enabled = getEnvironmentVariable(\"LANGCHAIN_TRACING_V2\") === \"true\";\n    const tracingEnabled = tracingV2Enabled || ((_getEnvironmentVariab = getEnvironmentVariable(\"LANGCHAIN_TRACING\")) !== null && _getEnvironmentVariab !== void 0 ? _getEnvironmentVariab : false);\n    if (verboseEnabled || tracingEnabled) {\n      if (!callbackManager) {\n        callbackManager = new CallbackManager();\n      }\n      if (verboseEnabled && !callbackManager.handlers.some(handler => handler.name === ConsoleCallbackHandler.prototype.name)) {\n        const consoleHandler = new ConsoleCallbackHandler();\n        callbackManager.addHandler(consoleHandler, true);\n      }\n      if (tracingEnabled && !callbackManager.handlers.some(handler => handler.name === \"langchain_tracer\")) {\n        if (tracingV2Enabled) {\n          callbackManager.addHandler(await getTracingV2CallbackHandler(), true);\n        }\n      }\n    }\n    if (inheritableTags || localTags) {\n      if (callbackManager) {\n        callbackManager.addTags(inheritableTags !== null && inheritableTags !== void 0 ? inheritableTags : []);\n        callbackManager.addTags(localTags !== null && localTags !== void 0 ? localTags : [], false);\n      }\n    }\n    if (inheritableMetadata || localMetadata) {\n      if (callbackManager) {\n        callbackManager.addMetadata(inheritableMetadata !== null && inheritableMetadata !== void 0 ? inheritableMetadata : {});\n        callbackManager.addMetadata(localMetadata !== null && localMetadata !== void 0 ? localMetadata : {}, false);\n      }\n    }\n    return callbackManager;\n  }\n}\nexport function ensureHandler(handler) {\n  if (\"name\" in handler) {\n    return handler;\n  }\n  return BaseCallbackHandler.fromMethods(handler);\n}\n/**\n * @example\n * ```typescript\n * const prompt = PromptTemplate.fromTemplate(`What is the answer to {question}?`);\n *\n * // Example of using LLMChain to process a series of questions\n * const chain = new LLMChain({\n *   llm: new ChatOpenAI({ temperature: 0.9 }),\n *   prompt,\n * });\n *\n * // Process questions using the chain\n * const processQuestions = async (questions) => {\n *   for (const question of questions) {\n *     const result = await chain.call({ question });\n *     console.log(result);\n *   }\n * };\n *\n * // Example questions\n * const questions = [\n *   \"What is your name?\",\n *   \"What is your quest?\",\n *   \"What is your favorite color?\",\n * ];\n *\n * // Run the example\n * processQuestions(questions).catch(console.error);\n *\n * ```\n */\nexport class TraceGroup {\n  constructor(groupName, options) {\n    Object.defineProperty(this, \"groupName\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: groupName\n    });\n    Object.defineProperty(this, \"options\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: options\n    });\n    Object.defineProperty(this, \"runManager\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n  }\n  async getTraceGroupCallbackManager(group_name, inputs, options) {\n    const cb = new LangChainTracer(options);\n    const cm = await CallbackManager.configure([cb]);\n    const runManager = await (cm === null || cm === void 0 ? void 0 : cm.handleChainStart({\n      lc: 1,\n      type: \"not_implemented\",\n      id: [\"langchain\", \"callbacks\", \"groups\", group_name]\n    }, inputs !== null && inputs !== void 0 ? inputs : {}));\n    if (!runManager) {\n      throw new Error(\"Failed to create run group callback manager.\");\n    }\n    return runManager;\n  }\n  async start(inputs) {\n    if (!this.runManager) {\n      this.runManager = await this.getTraceGroupCallbackManager(this.groupName, inputs, this.options);\n    }\n    return this.runManager.getChild();\n  }\n  async error(err) {\n    if (this.runManager) {\n      await this.runManager.handleChainError(err);\n      this.runManager = undefined;\n    }\n  }\n  async end(output) {\n    if (this.runManager) {\n      await this.runManager.handleChainEnd(output !== null && output !== void 0 ? output : {});\n      this.runManager = undefined;\n    }\n  }\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction _coerceToDict(value, defaultKey) {\n  return value && !Array.isArray(value) && typeof value === \"object\" ? value : {\n    [defaultKey]: value\n  };\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport async function traceAsGroup(groupOptions, enclosedCode) {\n  const traceGroup = new TraceGroup(groupOptions.name, groupOptions);\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n  const callbackManager = await traceGroup.start({\n    ...args\n  });\n  try {\n    const result = await enclosedCode(callbackManager, ...args);\n    await traceGroup.end(_coerceToDict(result, \"output\"));\n    return result;\n  } catch (err) {\n    await traceGroup.error(err);\n    throw err;\n  }\n}","map":{"version":3,"names":["v4","uuidv4","BaseCallbackHandler","ConsoleCallbackHandler","getTracingV2CallbackHandler","getBufferString","getEnvironmentVariable","LangChainTracer","consumeCallback","parseCallbackConfigArg","arg","Array","isArray","callbacks","BaseCallbackManager","setHandler","handler","setHandlers","BaseRunManager","constructor","runId","handlers","inheritableHandlers","tags","inheritableTags","metadata","inheritableMetadata","_parentRunId","Object","defineProperty","enumerable","configurable","writable","value","handleText","text","Promise","all","map","_handler$handleText","call","err","console","error","concat","name","awaitHandlers","CallbackManagerForRetrieverRun","getChild","tag","manager","CallbackManager","addTags","addMetadata","handleRetrieverEnd","documents","ignoreRetriever","_handler$handleRetrie","handleRetrieverError","_handler$handleRetrie2","CallbackManagerForLLMRun","handleLLMNewToken","token","idx","_runId","_tags","fields","ignoreLLM","_handler$handleLLMNew","prompt","completion","handleLLMError","_handler$handleLLMErr","handleLLMEnd","output","_handler$handleLLMEnd","CallbackManagerForChainRun","handleChainError","kwargs","ignoreChain","_handler$handleChainE","handleChainEnd","_handler$handleChainE2","handleAgentAction","action","ignoreAgent","_handler$handleAgentA","handleAgentEnd","_handler$handleAgentE","CallbackManagerForToolRun","handleToolError","_handler$handleToolEr","handleToolEnd","_handler$handleToolEn","parentRunId","options","_options$handlers","_options$inheritableH","_options$tags","_options$inheritableT","_options$metadata","_options$inheritableM","handleLLMStart","llm","prompts","arguments","length","undefined","extraParams","_metadata","runName","_handler$handleLLMSta","handleChatModelStart","messages","messageGroup","_handler$handleChatMo","_handler$handleLLMSta2","messageString","handleChainStart","chain","inputs","runType","_handler$handleChainS","handleToolStart","tool","input","_handler$handleToolSt","handleRetrieverStart","retriever","query","_handler$handleRetrie3","addHandler","inherit","push","removeHandler","filter","_handler","removeTags","includes","removeMetadata","key","keys","copy","additionalHandlers","inheritable","h","some","fromHandlers","Handler","assign","configure","localHandlers","localTags","localMetadata","_getEnvironmentVariab","callbackManager","_inheritableHandlers$","ensureHandler","verboseEnabled","verbose","tracingV2Enabled","tracingEnabled","prototype","consoleHandler","fromMethods","TraceGroup","groupName","getTraceGroupCallbackManager","group_name","cb","cm","runManager","lc","type","id","Error","start","end","_coerceToDict","defaultKey","traceAsGroup","groupOptions","enclosedCode","traceGroup","_len","args","_key","result"],"sources":["/Users/mandylin/Desktop/WebCrack React 2/webcrack/node_modules/@langchain/core/dist/callbacks/manager.js"],"sourcesContent":["import { v4 as uuidv4 } from \"uuid\";\nimport { BaseCallbackHandler, } from \"./base.js\";\nimport { ConsoleCallbackHandler } from \"../tracers/console.js\";\nimport { getTracingV2CallbackHandler } from \"../tracers/initialize.js\";\nimport { getBufferString } from \"../messages/index.js\";\nimport { getEnvironmentVariable } from \"../utils/env.js\";\nimport { LangChainTracer, } from \"../tracers/tracer_langchain.js\";\nimport { consumeCallback } from \"./promises.js\";\nexport function parseCallbackConfigArg(arg) {\n    if (!arg) {\n        return {};\n    }\n    else if (Array.isArray(arg) || \"name\" in arg) {\n        return { callbacks: arg };\n    }\n    else {\n        return arg;\n    }\n}\n/**\n * Manage callbacks from different components of LangChain.\n */\nexport class BaseCallbackManager {\n    setHandler(handler) {\n        return this.setHandlers([handler]);\n    }\n}\n/**\n * Base class for run manager in LangChain.\n */\nclass BaseRunManager {\n    constructor(runId, handlers, inheritableHandlers, tags, inheritableTags, metadata, inheritableMetadata, _parentRunId) {\n        Object.defineProperty(this, \"runId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: runId\n        });\n        Object.defineProperty(this, \"handlers\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: handlers\n        });\n        Object.defineProperty(this, \"inheritableHandlers\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: inheritableHandlers\n        });\n        Object.defineProperty(this, \"tags\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: tags\n        });\n        Object.defineProperty(this, \"inheritableTags\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: inheritableTags\n        });\n        Object.defineProperty(this, \"metadata\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: metadata\n        });\n        Object.defineProperty(this, \"inheritableMetadata\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: inheritableMetadata\n        });\n        Object.defineProperty(this, \"_parentRunId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _parentRunId\n        });\n    }\n    async handleText(text) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            try {\n                await handler.handleText?.(text, this.runId, this._parentRunId, this.tags);\n            }\n            catch (err) {\n                console.error(`Error in handler ${handler.constructor.name}, handleText: ${err}`);\n            }\n        }, handler.awaitHandlers)));\n    }\n}\n/**\n * Manages callbacks for retriever runs.\n */\nexport class CallbackManagerForRetrieverRun extends BaseRunManager {\n    getChild(tag) {\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        const manager = new CallbackManager(this.runId);\n        manager.setHandlers(this.inheritableHandlers);\n        manager.addTags(this.inheritableTags);\n        manager.addMetadata(this.inheritableMetadata);\n        if (tag) {\n            manager.addTags([tag], false);\n        }\n        return manager;\n    }\n    async handleRetrieverEnd(documents) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreRetriever) {\n                try {\n                    await handler.handleRetrieverEnd?.(documents, this.runId, this._parentRunId, this.tags);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleRetriever`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n    async handleRetrieverError(err) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreRetriever) {\n                try {\n                    await handler.handleRetrieverError?.(err, this.runId, this._parentRunId, this.tags);\n                }\n                catch (error) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleRetrieverError: ${error}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n}\nexport class CallbackManagerForLLMRun extends BaseRunManager {\n    async handleLLMNewToken(token, idx, _runId, _parentRunId, _tags, fields) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreLLM) {\n                try {\n                    await handler.handleLLMNewToken?.(token, idx ?? { prompt: 0, completion: 0 }, this.runId, this._parentRunId, this.tags, fields);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleLLMNewToken: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n    async handleLLMError(err) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreLLM) {\n                try {\n                    await handler.handleLLMError?.(err, this.runId, this._parentRunId, this.tags);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleLLMError: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n    async handleLLMEnd(output) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreLLM) {\n                try {\n                    await handler.handleLLMEnd?.(output, this.runId, this._parentRunId, this.tags);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleLLMEnd: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n}\nexport class CallbackManagerForChainRun extends BaseRunManager {\n    getChild(tag) {\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        const manager = new CallbackManager(this.runId);\n        manager.setHandlers(this.inheritableHandlers);\n        manager.addTags(this.inheritableTags);\n        manager.addMetadata(this.inheritableMetadata);\n        if (tag) {\n            manager.addTags([tag], false);\n        }\n        return manager;\n    }\n    async handleChainError(err, _runId, _parentRunId, _tags, kwargs) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreChain) {\n                try {\n                    await handler.handleChainError?.(err, this.runId, this._parentRunId, this.tags, kwargs);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleChainError: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n    async handleChainEnd(output, _runId, _parentRunId, _tags, kwargs) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreChain) {\n                try {\n                    await handler.handleChainEnd?.(output, this.runId, this._parentRunId, this.tags, kwargs);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleChainEnd: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n    async handleAgentAction(action) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreAgent) {\n                try {\n                    await handler.handleAgentAction?.(action, this.runId, this._parentRunId, this.tags);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleAgentAction: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n    async handleAgentEnd(action) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreAgent) {\n                try {\n                    await handler.handleAgentEnd?.(action, this.runId, this._parentRunId, this.tags);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleAgentEnd: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n}\nexport class CallbackManagerForToolRun extends BaseRunManager {\n    getChild(tag) {\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        const manager = new CallbackManager(this.runId);\n        manager.setHandlers(this.inheritableHandlers);\n        manager.addTags(this.inheritableTags);\n        manager.addMetadata(this.inheritableMetadata);\n        if (tag) {\n            manager.addTags([tag], false);\n        }\n        return manager;\n    }\n    async handleToolError(err) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreAgent) {\n                try {\n                    await handler.handleToolError?.(err, this.runId, this._parentRunId, this.tags);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleToolError: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n    async handleToolEnd(output) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreAgent) {\n                try {\n                    await handler.handleToolEnd?.(output, this.runId, this._parentRunId, this.tags);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleToolEnd: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n    }\n}\n/**\n * @example\n * ```typescript\n * const prompt = PromptTemplate.fromTemplate(\"What is the answer to {question}?\");\n *\n * // Example of using LLMChain with OpenAI and a simple prompt\n * const chain = new LLMChain({\n *   llm: new ChatOpenAI({ temperature: 0.9 }),\n *   prompt,\n * });\n *\n * // Running the chain with a single question\n * const result = await chain.call({\n *   question: \"What is the airspeed velocity of an unladen swallow?\",\n * });\n * console.log(\"The answer is:\", result);\n * ```\n */\nexport class CallbackManager extends BaseCallbackManager {\n    constructor(parentRunId, options) {\n        super();\n        Object.defineProperty(this, \"handlers\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: []\n        });\n        Object.defineProperty(this, \"inheritableHandlers\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: []\n        });\n        Object.defineProperty(this, \"tags\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: []\n        });\n        Object.defineProperty(this, \"inheritableTags\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: []\n        });\n        Object.defineProperty(this, \"metadata\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"inheritableMetadata\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"callback_manager\"\n        });\n        Object.defineProperty(this, \"_parentRunId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.handlers = options?.handlers ?? this.handlers;\n        this.inheritableHandlers =\n            options?.inheritableHandlers ?? this.inheritableHandlers;\n        this.tags = options?.tags ?? this.tags;\n        this.inheritableTags = options?.inheritableTags ?? this.inheritableTags;\n        this.metadata = options?.metadata ?? this.metadata;\n        this.inheritableMetadata =\n            options?.inheritableMetadata ?? this.inheritableMetadata;\n        this._parentRunId = parentRunId;\n    }\n    async handleLLMStart(llm, prompts, _runId = undefined, _parentRunId = undefined, extraParams = undefined, _tags = undefined, _metadata = undefined, runName = undefined) {\n        return Promise.all(prompts.map(async (prompt) => {\n            const runId = uuidv4();\n            await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n                if (!handler.ignoreLLM) {\n                    try {\n                        await handler.handleLLMStart?.(llm, [prompt], runId, this._parentRunId, extraParams, this.tags, this.metadata, runName);\n                    }\n                    catch (err) {\n                        console.error(`Error in handler ${handler.constructor.name}, handleLLMStart: ${err}`);\n                    }\n                }\n            }, handler.awaitHandlers)));\n            return new CallbackManagerForLLMRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n        }));\n    }\n    async handleChatModelStart(llm, messages, _runId = undefined, _parentRunId = undefined, extraParams = undefined, _tags = undefined, _metadata = undefined, runName = undefined) {\n        return Promise.all(messages.map(async (messageGroup) => {\n            const runId = uuidv4();\n            await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n                if (!handler.ignoreLLM) {\n                    try {\n                        if (handler.handleChatModelStart) {\n                            await handler.handleChatModelStart?.(llm, [messageGroup], runId, this._parentRunId, extraParams, this.tags, this.metadata, runName);\n                        }\n                        else if (handler.handleLLMStart) {\n                            const messageString = getBufferString(messageGroup);\n                            await handler.handleLLMStart?.(llm, [messageString], runId, this._parentRunId, extraParams, this.tags, this.metadata, runName);\n                        }\n                    }\n                    catch (err) {\n                        console.error(`Error in handler ${handler.constructor.name}, handleLLMStart: ${err}`);\n                    }\n                }\n            }, handler.awaitHandlers)));\n            return new CallbackManagerForLLMRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n        }));\n    }\n    async handleChainStart(chain, inputs, runId = uuidv4(), runType = undefined, _tags = undefined, _metadata = undefined, runName = undefined) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreChain) {\n                try {\n                    await handler.handleChainStart?.(chain, inputs, runId, this._parentRunId, this.tags, this.metadata, runType, runName);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleChainStart: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n        return new CallbackManagerForChainRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n    }\n    async handleToolStart(tool, input, runId = uuidv4(), _parentRunId = undefined, _tags = undefined, _metadata = undefined, runName = undefined) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreAgent) {\n                try {\n                    await handler.handleToolStart?.(tool, input, runId, this._parentRunId, this.tags, this.metadata, runName);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleToolStart: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n        return new CallbackManagerForToolRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n    }\n    async handleRetrieverStart(retriever, query, runId = uuidv4(), _parentRunId = undefined, _tags = undefined, _metadata = undefined, runName = undefined) {\n        await Promise.all(this.handlers.map((handler) => consumeCallback(async () => {\n            if (!handler.ignoreRetriever) {\n                try {\n                    await handler.handleRetrieverStart?.(retriever, query, runId, this._parentRunId, this.tags, this.metadata, runName);\n                }\n                catch (err) {\n                    console.error(`Error in handler ${handler.constructor.name}, handleRetrieverStart: ${err}`);\n                }\n            }\n        }, handler.awaitHandlers)));\n        return new CallbackManagerForRetrieverRun(runId, this.handlers, this.inheritableHandlers, this.tags, this.inheritableTags, this.metadata, this.inheritableMetadata, this._parentRunId);\n    }\n    addHandler(handler, inherit = true) {\n        this.handlers.push(handler);\n        if (inherit) {\n            this.inheritableHandlers.push(handler);\n        }\n    }\n    removeHandler(handler) {\n        this.handlers = this.handlers.filter((_handler) => _handler !== handler);\n        this.inheritableHandlers = this.inheritableHandlers.filter((_handler) => _handler !== handler);\n    }\n    setHandlers(handlers, inherit = true) {\n        this.handlers = [];\n        this.inheritableHandlers = [];\n        for (const handler of handlers) {\n            this.addHandler(handler, inherit);\n        }\n    }\n    addTags(tags, inherit = true) {\n        this.removeTags(tags); // Remove duplicates\n        this.tags.push(...tags);\n        if (inherit) {\n            this.inheritableTags.push(...tags);\n        }\n    }\n    removeTags(tags) {\n        this.tags = this.tags.filter((tag) => !tags.includes(tag));\n        this.inheritableTags = this.inheritableTags.filter((tag) => !tags.includes(tag));\n    }\n    addMetadata(metadata, inherit = true) {\n        this.metadata = { ...this.metadata, ...metadata };\n        if (inherit) {\n            this.inheritableMetadata = { ...this.inheritableMetadata, ...metadata };\n        }\n    }\n    removeMetadata(metadata) {\n        for (const key of Object.keys(metadata)) {\n            delete this.metadata[key];\n            delete this.inheritableMetadata[key];\n        }\n    }\n    copy(additionalHandlers = [], inherit = true) {\n        const manager = new CallbackManager(this._parentRunId);\n        for (const handler of this.handlers) {\n            const inheritable = this.inheritableHandlers.includes(handler);\n            manager.addHandler(handler, inheritable);\n        }\n        for (const tag of this.tags) {\n            const inheritable = this.inheritableTags.includes(tag);\n            manager.addTags([tag], inheritable);\n        }\n        for (const key of Object.keys(this.metadata)) {\n            const inheritable = Object.keys(this.inheritableMetadata).includes(key);\n            manager.addMetadata({ [key]: this.metadata[key] }, inheritable);\n        }\n        for (const handler of additionalHandlers) {\n            if (\n            // Prevent multiple copies of console_callback_handler\n            manager.handlers\n                .filter((h) => h.name === \"console_callback_handler\")\n                .some((h) => h.name === handler.name)) {\n                continue;\n            }\n            manager.addHandler(handler, inherit);\n        }\n        return manager;\n    }\n    static fromHandlers(handlers) {\n        class Handler extends BaseCallbackHandler {\n            constructor() {\n                super();\n                Object.defineProperty(this, \"name\", {\n                    enumerable: true,\n                    configurable: true,\n                    writable: true,\n                    value: uuidv4()\n                });\n                Object.assign(this, handlers);\n            }\n        }\n        const manager = new this();\n        manager.addHandler(new Handler());\n        return manager;\n    }\n    static async configure(inheritableHandlers, localHandlers, inheritableTags, localTags, inheritableMetadata, localMetadata, options) {\n        let callbackManager;\n        if (inheritableHandlers || localHandlers) {\n            if (Array.isArray(inheritableHandlers) || !inheritableHandlers) {\n                callbackManager = new CallbackManager();\n                callbackManager.setHandlers(inheritableHandlers?.map(ensureHandler) ?? [], true);\n            }\n            else {\n                callbackManager = inheritableHandlers;\n            }\n            callbackManager = callbackManager.copy(Array.isArray(localHandlers)\n                ? localHandlers.map(ensureHandler)\n                : localHandlers?.handlers, false);\n        }\n        const verboseEnabled = getEnvironmentVariable(\"LANGCHAIN_VERBOSE\") === \"true\" ||\n            options?.verbose;\n        const tracingV2Enabled = getEnvironmentVariable(\"LANGCHAIN_TRACING_V2\") === \"true\";\n        const tracingEnabled = tracingV2Enabled ||\n            (getEnvironmentVariable(\"LANGCHAIN_TRACING\") ?? false);\n        if (verboseEnabled || tracingEnabled) {\n            if (!callbackManager) {\n                callbackManager = new CallbackManager();\n            }\n            if (verboseEnabled &&\n                !callbackManager.handlers.some((handler) => handler.name === ConsoleCallbackHandler.prototype.name)) {\n                const consoleHandler = new ConsoleCallbackHandler();\n                callbackManager.addHandler(consoleHandler, true);\n            }\n            if (tracingEnabled &&\n                !callbackManager.handlers.some((handler) => handler.name === \"langchain_tracer\")) {\n                if (tracingV2Enabled) {\n                    callbackManager.addHandler(await getTracingV2CallbackHandler(), true);\n                }\n            }\n        }\n        if (inheritableTags || localTags) {\n            if (callbackManager) {\n                callbackManager.addTags(inheritableTags ?? []);\n                callbackManager.addTags(localTags ?? [], false);\n            }\n        }\n        if (inheritableMetadata || localMetadata) {\n            if (callbackManager) {\n                callbackManager.addMetadata(inheritableMetadata ?? {});\n                callbackManager.addMetadata(localMetadata ?? {}, false);\n            }\n        }\n        return callbackManager;\n    }\n}\nexport function ensureHandler(handler) {\n    if (\"name\" in handler) {\n        return handler;\n    }\n    return BaseCallbackHandler.fromMethods(handler);\n}\n/**\n * @example\n * ```typescript\n * const prompt = PromptTemplate.fromTemplate(`What is the answer to {question}?`);\n *\n * // Example of using LLMChain to process a series of questions\n * const chain = new LLMChain({\n *   llm: new ChatOpenAI({ temperature: 0.9 }),\n *   prompt,\n * });\n *\n * // Process questions using the chain\n * const processQuestions = async (questions) => {\n *   for (const question of questions) {\n *     const result = await chain.call({ question });\n *     console.log(result);\n *   }\n * };\n *\n * // Example questions\n * const questions = [\n *   \"What is your name?\",\n *   \"What is your quest?\",\n *   \"What is your favorite color?\",\n * ];\n *\n * // Run the example\n * processQuestions(questions).catch(console.error);\n *\n * ```\n */\nexport class TraceGroup {\n    constructor(groupName, options) {\n        Object.defineProperty(this, \"groupName\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: groupName\n        });\n        Object.defineProperty(this, \"options\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: options\n        });\n        Object.defineProperty(this, \"runManager\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    async getTraceGroupCallbackManager(group_name, inputs, options) {\n        const cb = new LangChainTracer(options);\n        const cm = await CallbackManager.configure([cb]);\n        const runManager = await cm?.handleChainStart({\n            lc: 1,\n            type: \"not_implemented\",\n            id: [\"langchain\", \"callbacks\", \"groups\", group_name],\n        }, inputs ?? {});\n        if (!runManager) {\n            throw new Error(\"Failed to create run group callback manager.\");\n        }\n        return runManager;\n    }\n    async start(inputs) {\n        if (!this.runManager) {\n            this.runManager = await this.getTraceGroupCallbackManager(this.groupName, inputs, this.options);\n        }\n        return this.runManager.getChild();\n    }\n    async error(err) {\n        if (this.runManager) {\n            await this.runManager.handleChainError(err);\n            this.runManager = undefined;\n        }\n    }\n    async end(output) {\n        if (this.runManager) {\n            await this.runManager.handleChainEnd(output ?? {});\n            this.runManager = undefined;\n        }\n    }\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction _coerceToDict(value, defaultKey) {\n    return value && !Array.isArray(value) && typeof value === \"object\"\n        ? value\n        : { [defaultKey]: value };\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport async function traceAsGroup(groupOptions, enclosedCode, ...args) {\n    const traceGroup = new TraceGroup(groupOptions.name, groupOptions);\n    const callbackManager = await traceGroup.start({ ...args });\n    try {\n        const result = await enclosedCode(callbackManager, ...args);\n        await traceGroup.end(_coerceToDict(result, \"output\"));\n        return result;\n    }\n    catch (err) {\n        await traceGroup.error(err);\n        throw err;\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}