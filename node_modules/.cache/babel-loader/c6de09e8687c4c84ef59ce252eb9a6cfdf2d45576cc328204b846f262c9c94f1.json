{"ast":null,"code":"// utils -> linker\n\nimport { DOMParser } from 'linkedom';\nimport { findBestMatch } from './similarity.js';\nexport const isValid = function () {\n  let url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  try {\n    const ourl = new URL(url);\n    return ourl !== null && ourl.protocol.startsWith('http');\n  } catch (err) {\n    return false;\n  }\n};\nexport const chooseBestUrl = function () {\n  let candidates = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let title = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  const ranking = findBestMatch(title, candidates);\n  return ranking.bestMatch.target;\n};\nexport const absolutify = function () {\n  let fullUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  let relativeUrl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  try {\n    const result = new URL(relativeUrl, fullUrl);\n    return result.toString();\n  } catch (err) {\n    return '';\n  }\n};\nconst blacklistKeys = ['CNDID', '__twitter_impression', '_hsenc', '_openstat', 'action_object_map', 'action_ref_map', 'action_type_map', 'amp', 'fb_action_ids', 'fb_action_types', 'fb_ref', 'fb_source', 'fbclid', 'ga_campaign', 'ga_content', 'ga_medium', 'ga_place', 'ga_source', 'ga_term', 'gs_l', 'hmb_campaign', 'hmb_medium', 'hmb_source', 'mbid', 'mc_cid', 'mc_eid', 'mkt_tok', 'referrer', 'spJobID', 'spMailingID', 'spReportId', 'spUserID', 'utm_brand', 'utm_campaign', 'utm_cid', 'utm_content', 'utm_int', 'utm_mailing', 'utm_medium', 'utm_name', 'utm_place', 'utm_pubreferrer', 'utm_reader', 'utm_social', 'utm_source', 'utm_swu', 'utm_term', 'utm_userid', 'utm_viz_id', 'wt_mc_o', 'yclid', 'WT.mc_id', 'WT.mc_ev', 'WT.srch', 'pk_source', 'pk_medium', 'pk_campaign'];\nexport const purify = url => {\n  try {\n    const pureUrl = new URL(url);\n    blacklistKeys.forEach(key => {\n      pureUrl.searchParams.delete(key);\n    });\n    return pureUrl.toString().replace(pureUrl.hash, '');\n  } catch (err) {\n    return null;\n  }\n};\n\n/**\n * @param inputHtml {string}\n * @param url {string}\n * @returns article {string}\n */\nexport const normalize = (html, url) => {\n  const doc = new DOMParser().parseFromString(html, 'text/html');\n  Array.from(doc.getElementsByTagName('a')).forEach(element => {\n    const href = element.getAttribute('href');\n    if (href) {\n      element.setAttribute('href', absolutify(url, href));\n      element.setAttribute('target', '_blank');\n    }\n  });\n  Array.from(doc.getElementsByTagName('img')).forEach(element => {\n    var _element$getAttribute;\n    const src = (_element$getAttribute = element.getAttribute('data-src')) !== null && _element$getAttribute !== void 0 ? _element$getAttribute : element.getAttribute('src');\n    if (src) {\n      element.setAttribute('src', absolutify(url, src));\n    }\n  });\n  return Array.from(doc.childNodes).map(element => element.outerHTML).join('');\n};\nexport const getDomain = url => {\n  const host = new URL(url).host;\n  return host.replace('www.', '');\n};","map":{"version":3,"names":["DOMParser","findBestMatch","isValid","url","arguments","length","undefined","ourl","URL","protocol","startsWith","err","chooseBestUrl","candidates","title","ranking","bestMatch","target","absolutify","fullUrl","relativeUrl","result","toString","blacklistKeys","purify","pureUrl","forEach","key","searchParams","delete","replace","hash","normalize","html","doc","parseFromString","Array","from","getElementsByTagName","element","href","getAttribute","setAttribute","_element$getAttribute","src","childNodes","map","outerHTML","join","getDomain","host"],"sources":["/Users/mandylin/Desktop/WebCrack React 2/webcrack/node_modules/@extractus/article-extractor/src/utils/linker.js"],"sourcesContent":["// utils -> linker\n\nimport { DOMParser } from 'linkedom'\n\nimport { findBestMatch } from './similarity.js'\n\nexport const isValid = (url = '') => {\n  try {\n    const ourl = new URL(url)\n    return ourl !== null && ourl.protocol.startsWith('http')\n  } catch (err) {\n    return false\n  }\n}\n\nexport const chooseBestUrl = (candidates = [], title = '') => {\n  const ranking = findBestMatch(title, candidates)\n  return ranking.bestMatch.target\n}\n\nexport const absolutify = (fullUrl = '', relativeUrl = '') => {\n  try {\n    const result = new URL(relativeUrl, fullUrl)\n    return result.toString()\n  } catch (err) {\n    return ''\n  }\n}\n\nconst blacklistKeys = [\n  'CNDID',\n  '__twitter_impression',\n  '_hsenc',\n  '_openstat',\n  'action_object_map',\n  'action_ref_map',\n  'action_type_map',\n  'amp',\n  'fb_action_ids',\n  'fb_action_types',\n  'fb_ref',\n  'fb_source',\n  'fbclid',\n  'ga_campaign',\n  'ga_content',\n  'ga_medium',\n  'ga_place',\n  'ga_source',\n  'ga_term',\n  'gs_l',\n  'hmb_campaign',\n  'hmb_medium',\n  'hmb_source',\n  'mbid',\n  'mc_cid',\n  'mc_eid',\n  'mkt_tok',\n  'referrer',\n  'spJobID',\n  'spMailingID',\n  'spReportId',\n  'spUserID',\n  'utm_brand',\n  'utm_campaign',\n  'utm_cid',\n  'utm_content',\n  'utm_int',\n  'utm_mailing',\n  'utm_medium',\n  'utm_name',\n  'utm_place',\n  'utm_pubreferrer',\n  'utm_reader',\n  'utm_social',\n  'utm_source',\n  'utm_swu',\n  'utm_term',\n  'utm_userid',\n  'utm_viz_id',\n  'wt_mc_o',\n  'yclid',\n  'WT.mc_id',\n  'WT.mc_ev',\n  'WT.srch',\n  'pk_source',\n  'pk_medium',\n  'pk_campaign',\n]\n\nexport const purify = (url) => {\n  try {\n    const pureUrl = new URL(url)\n\n    blacklistKeys.forEach((key) => {\n      pureUrl.searchParams.delete(key)\n    })\n\n    return pureUrl.toString().replace(pureUrl.hash, '')\n  } catch (err) {\n    return null\n  }\n}\n\n/**\n * @param inputHtml {string}\n * @param url {string}\n * @returns article {string}\n */\nexport const normalize = (html, url) => {\n  const doc = new DOMParser().parseFromString(html, 'text/html')\n\n  Array.from(doc.getElementsByTagName('a')).forEach((element) => {\n    const href = element.getAttribute('href')\n    if (href) {\n      element.setAttribute('href', absolutify(url, href))\n      element.setAttribute('target', '_blank')\n    }\n  })\n\n  Array.from(doc.getElementsByTagName('img')).forEach((element) => {\n    const src = element.getAttribute('data-src') ?? element.getAttribute('src')\n    if (src) {\n      element.setAttribute('src', absolutify(url, src))\n    }\n  })\n\n  return Array.from(doc.childNodes).map(element => element.outerHTML).join('')\n}\n\nexport const getDomain = (url) => {\n  const host = (new URL(url)).host\n  return host.replace('www.', '')\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}